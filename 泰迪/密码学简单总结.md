---
title: 密码学简单总结
date: 2017-09-23 07:07:16
tags: 密码学
---
# 现代密码学

## 分类

### 流密码

反馈函数f(a1,a2,…,an)是n元布尔函数，即函数的自变量和因变量只取0和1这两个可能的值。
函数中的运算有逻辑与、逻辑或、逻辑补等运算。

本质上是类似队列的操作，将参数存入队列，每次出最前面一个之后入队列结果

### 分组密码
#### DES
分组长度为64 bits (8 bytes)
密文分组长度也是64 bits。
密钥长度为64 bits，有8 bits奇偶校验，有效密钥长度为56 bits。
算法主要包括：初始置换IP、16轮迭代的乘积变换、逆初始置换IP-1以及16个子密钥产生器。

* 总结
本质上是分组，循环移位。之后去查表变换和子钥匙异或并且轮询(16次)此操作，之后排列输出

* 安全性
DES的密钥(56)短了些。采用穷搜索对已经对DES构成了威胁．
就是传说的的爆破

几种模式
ECB模式，简单、高速，但最弱、易受重发攻击，一般不推荐。
CBC适用于文件加密，但较ECB慢。安全性加强。当有少量错误时，也不会造成同步错误。(padding oracle)
OFB和CFB较CBC慢许多。每次迭代只有少数bit完成加密。若可以容忍少量错误扩展，则可换来恢复同步能力，此时用CFB。在字符为单元的流密码中多选CFB模式。
OFB用于高速同步系统，不容忍差错传播。


#### 2DES
用DES进行两次加密，但这是否就意味着两重DES加密的强度等价于112 bit密钥的密码的强度？
答案是否定的

* 安全
中途相遇攻击
破译双重DES的难度为2^57量级

#### 3DES
加密：y=Ek1[Dk2[Ek1 [x]]]
解密：x=Dk1[Ek2[Dk1[y]]]

称其为加密-解密-加密方案，简记为EDE(encrypt-decrypt-encrypt)。

* 安全
破译它的穷举密钥搜索量为2^112 = 5×10^35量级，而用差分分析破译也要超过10^52量级。

#### AES

本质上是位元取代，移位列，混合行的迭代


#### RC4
本质上，是考一套生成密钥的算法生成不同的密钥进行异或

* 安全性
如果存在密钥生成算法生成一个相同的密钥，这样就可能获取到明文
应用点
```txt
WEP密码破解原理
     ·IV并非随机值
     ·每224个包可能出现一个IV重用
     ·收集大量的IV之后找出其对应的密文，分析得出共享密码
·ARP回包包含IV
·IV足够多的情况下，任何复杂度的WEP密码都可以破解
```


### 非对称加密

#### Diffie-Hellman

#### RSA
1. 第一步，随机选择两个不相等的质数p和q。
2. 第二步，计算p和q的乘积n。(n换成2进制就是密钥长度)
3. 第三步，计算n的欧拉函数φ(n)。φ(n) = (p-1)(q-1)
4. 第四步，随机选择一个整数e，条件是1< e < φ(n)，且e与φ(n) 互质(实际应用中，常常选择65537)
5. 计算e对于φ(n)的模反元素d。
>所谓"模反元素"就是指有一个整数d，可以使得ed被φ(n)除的余数为1。
　　ed ≡ 1 (mod φ(n))
这个式子等价于
　　ed - 1 = kφ(n)
于是，找到模反元素d，实质上就是对下面这个二元一次方程求解。
　　ex + φ(n)y = 1
已知 e=17, φ(n)=3120，
　　17x + 3120y = 1
这个方程可以用"扩展欧几里得算法"求解，此处省略具体过程。总之，爱丽丝算出一组整数解为 (x,y)=(2753,-15)，即 d=2753。


* 应用HTTPS
握手、协商加密算法、获取公钥证书、验证公钥证书、交换会话密钥、加密信息、传输






### 杂凑算法

#### SHA1


#### MD5

***

## 攻击方法
1. 穷举攻击：通过试遍所有的密钥来进行破译。
   对抗：可增大密钥的数量。
2. 统计分析攻击：通过分析密文和明文的统计规律来破译。
   对抗：设法使明文和密文的统计规律不一样。
3. 解密变换攻击：针对加密变换的数学基础，通过数学求解设法找到解密变换。
   对抗：选用具有坚实的数学基础和足够复杂的加密算法

## 攻击情况
1. 唯密文攻击：密码分析者仅知道一些密文。
2. 已知明文攻击：密码分析者知道一些明文和相应的密文。
3. 选择明文攻击：密码分析者可以选择一些明文，并得到相应的密文。
4. 选择密文攻击：密码分析者可以选择一些密文，并得到相应的明文。

## 密码准则
1. 破译密文的代价超过被加密信息的价值。
2. 破译密文所花的时间超过信息的有用期。
-
